<!-- - -
 ! Targeted by Git Hub adaptor link `README.md`, this file is written in Markdown compatible HTML. -->
<h1 lang='en-CA'>Transforming Breccia to HTML</h1>
<section lang='en-CA'> <!-- Introduction -->
    <p>
        Here is project Breccia.Web.imager.  This project implements a Web imager for Breccia,
        a tool that transforms Breccian markup to HTML.
        </p>
    </section>
<section lang='en-CA'> <!-- Copying -->
    <p>
        Copyright © 2019, Michael Allan and contributors.
        The files for this project are released under an <a href='LICENCE.txt'>MIT licence</a>.
        </p>
    <ul>
        <li>Web copy of latest files at <a href='http://reluk.ca/project/Breccia/Web/imager/'>
            reluk.ca</a>.</li>
        <li>Browsable revision history at <a>Git Hub</a>.* (top of this page)</li>
        <li>
            Bare `.git` clones at
            <a href=    'http://reluk.ca/var/repo/git/Breccia.Web.imager.git'>reluk.ca</a> or
            <a href='https://github.com/Michael-Allan/Breccia.Web.imager.git'>Git Hub</a>.*
            </li>
        <li>
            Project <a href='project_installation.brec'>installation instructions</a>.
            <div style='font-size:0.85em; margin-left:1em; margin-top:0.3em; opacity:0.7'>
                * Branch `reluk.ca` is liable to be rebased, `master` is stable.
                </div>
            </li>
        </ul>
    </section>
<script> // Inadvertently this all renders when viewed on Git Hub.
    ( function()
    {

        /** Corrects hyperlinks and related content of this document under the assumption
          * that it is *not* served from Git Hub.
          */
        function amend()
        {
            if( typeof document.createNodeIterator !== 'function' ) return;

            let isCorrect_github = false;
            let isCorrect_reluk = docLoc.indexOf('//reluk.ca/') < 0;
            const traversal = document.createNodeIterator( document.body, NodeFilter.SHOW_ELEMENT );
            for( traversal.nextNode()/*onto the body element itself*/;; )
            {
                const t = traversal.nextNode();
                if( t === null ) break;

                if( t.localName !== 'a' ) continue;

                let maybeFinished = false;
                if( !isCorrect_reluk && t.href === 'http://reluk.ca/project/Breccia/Web/imager/' )
                {
                  // Disable useless hyperlink, appending text directions instead
                  // ─────────────────────────
                    t.removeAttribute( 'href' );
                    const text = document.createTextNode( ' (top of this page)' );
                    t.parentNode.appendChild( text, t.nextSibling );
                    isCorrect_reluk = maybeFinished = true;
                }
                if( !isCorrect_github )
                {
                    let text = asText( t.firstChild );
                    if( text && text.data === 'Git Hub' )
                    {
                        text = asText( t.nextSibling );
                        if( text !== null )
                        {
                          // Remove deceptive text directions, enabling the hyperlink instead
                          // ────────────────────────────────
                            text.replaceData( 2, text.length, '' ); // Removing the parenthetic trailer.
                            t.setAttribute( 'href',
                              'https://github.com/Michael-Allan/Breccia.Web.imager/' );
                            isCorrect_github = maybeFinished = true;
                        }
                    }
                }
                if( maybeFinished && isCorrect_github && isCorrect_reluk ) break;
            }
        }


        /** @return The given node if it is a text node, otherwise null.
          */
        function asText( node ) { return node.nodeType === /*Node.TEXT_NODE*/3? node : null; }


        const docLoc = document.URL;


    ////////////////////

        if( docLoc.indexOf('//github.com/') < 0 ) amend();

    }() );
    </script>
